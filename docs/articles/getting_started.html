<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with VoxHunt • VoxHunt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with VoxHunt">
<meta property="og:description" content="voxhunt">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VoxHunt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/install.html">Install</a>
</li>
<li>
  <a href="../articles/getting_started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Exploing the Allen Brain Atlas</a>
    </li>
    <li>
      <a href="../articles/other_references.html">Other references</a>
    </li>
    <li>
      <a href="../articles/deconvolution.html">Deconvolution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://bsse.ethz.ch/qdb">
    <span class="fas fa-university fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/quadbiolab/VoxHunt">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting_started_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with VoxHunt</h1>
            
      
      
      <div class="hidden name"><code>getting_started.Rmd</code></div>

    </div>

    
    
<p>This vignette gives you an introduction on how to use VoxHunt to swiftly explore the Developing Mouse Brain Atlas ISH data, find brain structure-specific markers and project organoid cells to spatial brain maps.</p>
<div id="exploring-the-aba" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-aba" class="anchor"></a>Exploring the ABA</h2>
<p>VoxHunt provides a number of convenient functions to explore the Allen Developing Mouse Brain Atlas data computationally using R. To do so, you first need to point VoxHunt to the ABA gene expression data, which you can download <a href="https://data.mendeley.com/datasets/g4xg38mwcn/2">here</a>. Now, we’ll point VoxHunt to the location of these files:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/quadbiolab/VoxHunt">voxhunt</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/load_aba_data.html">load_aba_data</a></span><span class="op">(</span><span class="st">'~/path/to/data'</span><span class="op">)</span></code></pre></div>
<p>Per default, VoxHunt will not load all of the data at once, but only when we require it.</p>
<p>Now that we have the data, we can start exploring. For instance, you can plot the E13.5 and P14 mouse brain with annotated brain structures:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">voxhunt</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">'E13'</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">voxhunt</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">'P4'</span>, show_legend<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>We can also plot the expression of different genes over these voxel maps:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'NEUROD6'</span>, <span class="st">'EOMES'</span>, <span class="st">'DCN'</span>, <span class="st">'DLX1'</span>, <span class="st">'DLX2'</span>, <span class="st">'GBX2'</span>, <span class="st">'OTX2'</span>, <span class="st">'GATA3'</span>, <span class="st">'PAX8'</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_expression.html">plot_expression</a></span><span class="op">(</span><span class="st">'E15'</span>, genes <span class="op">=</span> <span class="va">genes</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>Here we plotted just the sagittal view with a maximum intensity projection for all voxels, sometimes this hides the expression of certain genes. VoxHunt also allows you to define the sections that will be used in the plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_expression.html">plot_expression</a></span><span class="op">(</span><span class="st">'E15'</span>, genes <span class="op">=</span> <span class="st">'DCN'</span>, slices <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-7-1.png" width="192"></p>
<p>We can also plot the expression of multiple genes for many coronal sections at the same time:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_expression.html">plot_expression</a></span><span class="op">(</span>
    <span class="st">'E15'</span>, 
    genes <span class="op">=</span> <span class="va">genes</span>, 
    view <span class="op">=</span> <span class="st">'slice'</span>, 
    slices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span><span class="op">)</span>
<span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>In addition to plotting well-known canonical markers, we can also perform DE to find specific markers for brain structures we are interested in:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">marker_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/structure_markers.html">structure_markers</a></span><span class="op">(</span><span class="st">'E15'</span>, annotation_level <span class="op">=</span> <span class="st">'custom_4'</span><span class="op">)</span>
<span class="va">hippo_markers</span> <span class="op">&lt;-</span> <span class="va">marker_df</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="st">'hippocampus'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">top_n</span><span class="op">(</span><span class="fl">2</span>, <span class="va">auc</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_expression.html">plot_expression</a></span><span class="op">(</span><span class="st">'E15'</span>, genes<span class="op">=</span><span class="va">hippo_markers</span><span class="op">$</span><span class="va">gene</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
</div>
<div id="spatial-similarity-maps" class="section level2">
<h2 class="hasAnchor">
<a href="#spatial-similarity-maps" class="anchor"></a>Spatial similarity maps</h2>
<p>Ok, now to the interesting part: mapping single cell transcriptomes. Projecting single cells to these spatial maps based on several hundred genes can be very informative about cell type composition of the organoid. First, we load an Seurat object. The example case we use here contains 2300 cells from cerebral organoids.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">example_seurat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">example_seurat</span><span class="op">@</span><span class="va">meta.data</span><span class="op">)</span></code></pre></div>
<pre><code>##                  orig.ident nCount_RNA nFeature_RNA          cluster
## cerebral_HC00013   cerebral   3313.979         3030     ctx_cerebral
## cerebral_HC00030   cerebral   3080.682         2422     ctx_cerebral
## cerebral_HC00036   cerebral   3097.781         2295     ctx_cerebral
## cerebral_HC00040   cerebral   3683.972         4453     ctx_cerebral
## cerebral_HC00043   cerebral   2301.335         1389 dien_ex_cerebral
## cerebral_HC00046   cerebral   2912.589         2368      ge_cerebral</code></pre>
<p>Before we start mapping the cells, we’ll do some feature selection to get region specific genes from the ABA:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regional_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/structure_markers.html">structure_markers</a></span><span class="op">(</span><span class="st">'E13'</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">top_n</span><span class="op">(</span><span class="fl">10</span>, <span class="va">auc</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">regional_markers</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "OTP"    "MEST"   "DLK1"   "PEG10"  "CDH8"   "PLXNC1"</code></pre>
<p>Now let’s use these markers to map our single cells to the brain. The <code>group_name</code> parameter refers to a metadata column that groups the data into clusters or cell types.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vox_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/voxel_map.html">voxel_map</a></span><span class="op">(</span>
    <span class="va">example_seurat</span>, 
    stage <span class="op">=</span> <span class="st">'E13'</span>, 
    group_name <span class="op">=</span> <span class="st">'cluster'</span>, 
    genes_use <span class="op">=</span> <span class="va">regional_markers</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">vox_map</span><span class="op">)</span></code></pre></div>
<pre><code>## A VoxelMap object
## 3 groups mapped to
## 9510 voxels in the E13 mouse brain
## based on 183 features</code></pre>
<p>We can first look at the coarse-grained level, what brain structures these cell types are most similar to:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_structure_similarity.html">plot_structure_similarity</a></span><span class="op">(</span><span class="va">vox_map</span>, cluster<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<p>Here, we can already appreciate that our cell types have distinct similarity patterns to certain brain structures, i.e. cortical neurons are similar to the pallium, GE neurons to the subpallium and diencephalic neurons to the diencephalon.</p>
<p>We can further explore our voxel map more spatially. The <code><a href="../reference/plot_map.html">plot_map()</a></code> function lets us plot spatial similarity maps in a number of different ways. Per default, it will show us a sagittal view of the projection for each of the groups:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span><span class="va">vox_map</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>However, as we have seen with the expression plots, we can also slice these voxel maps however we want to reveal structures that might be hidden in the sagittal projection. For instance, the highest correlation for the GE neurons seem to be hidden somewhere inside the brain, so lets look at fewer coronal sections:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span><span class="va">vox_map</span>, view<span class="op">=</span><span class="st">'slice'</span>, slices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">40</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/no_legend.html">no_legend</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-15-1.png" width="288"></p>
<p>Finally, VoxHunt also allows you to explore similarity maps interactively in 3D with a little help of plotly:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_map_3d.html">plot_map_3d</a></span><span class="op">(</span>
    <span class="va">vox_map</span>, 
    show_group <span class="op">=</span> <span class="st">'ctx_cerebral'</span>, 
    width <span class="op">=</span> <span class="fl">800</span>, 
    height <span class="op">=</span> <span class="fl">600</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="custom-plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-plotting" class="anchor"></a>Custom plotting</h2>
<p>VoxHunt provides some basic plotting functions to visualize the similarity maps. Of course, you go beyond those if you are familiar with plotting in R. To turn a VoxelMap or ReferenceMap object into a data frame for plotting with e.g. <code>ggplot()</code>, VoxHunt provides some convenience functions that return either group (<code><a href="../reference/summarize_groups.BrainSpanMap.html">summarize_groups()</a></code>) or structure summaries (<code><a href="../reference/summarize_structures.BrainSpanMap.html">summarize_structures()</a></code>) of the map:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">group_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarize_groups.BrainSpanMap.html">summarize_groups</a></span><span class="op">(</span><span class="va">vox_map</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">group_map</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 27
##   voxel  group  corr stage structure_name     x     y     z structure_id level_1
##   &lt;chr&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  
## 1 E13pt… ctx_… 0.524 E13   superficial s…    18    26     0    111220560 forebr…
## 2 E13pt… ctx_… 0.512 E13   superficial s…    19    26     0    111220560 forebr…
## 3 E13pt… ctx_… 0.605 E13   superficial s…    15    25     0    111220560 forebr…
## 4 E13pt… ctx_… 0.578 E13   intermediate …    16    25     0    111220558 forebr…
## 5 E13pt… ctx_… 0.552 E13   periventricul…    17    25     0    111220556 forebr…
## 6 E13pt… ctx_… 0.540 E13   periventricul…    18    25     0    111220556 forebr…
## # … with 17 more variables: level_2 &lt;chr&gt;, level_3 &lt;chr&gt;, level_4 &lt;chr&gt;,
## #   level_5 &lt;chr&gt;, level_6 &lt;chr&gt;, level_7 &lt;lgl&gt;, level_8 &lt;lgl&gt;, level_9 &lt;lgl&gt;,
## #   level_10 &lt;lgl&gt;, custom_1 &lt;chr&gt;, custom_2 &lt;chr&gt;, custom_3 &lt;chr&gt;,
## #   custom_4 &lt;chr&gt;, stratum &lt;chr&gt;, idx &lt;dbl&gt;, ge_annot &lt;chr&gt;, ctx_annot &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">struct_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarize_structures.BrainSpanMap.html">summarize_structures</a></span><span class="op">(</span><span class="va">vox_map</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">struct_map</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   cell             struct                         corr group           
##   &lt;chr&gt;            &lt;fct&gt;                         &lt;dbl&gt; &lt;fct&gt;           
## 1 ctx_cerebral     caudal hypothalamus          0.0743 ctx_cerebral    
## 2 dien_ex_cerebral caudal hypothalamus          0.0883 dien_ex_cerebral
## 3 ge_cerebral      caudal hypothalamus          0.154  ge_cerebral     
## 4 ctx_cerebral     caudal septocommissural area 0.0292 ctx_cerebral    
## 5 dien_ex_cerebral caudal septocommissural area 0.0920 dien_ex_cerebral
## 6 ge_cerebral      caudal septocommissural area 0.0498 ge_cerebral</code></pre>
<p>If you’d like to visualize the structure similarities in a low dimensional embedding of single-cell space (e.g. UMAP), you can use <code><a href="../reference/assign_cells.html">assign_cells()</a></code> to assign each cell to the maximum correalting voxel. The resulting dataframe can then be joined with the embedding coordinates or added to the <code>Seurat</code> metadata for plotting.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cell_assignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_cells.html">assign_cells</a></span><span class="op">(</span><span class="va">vox_map</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cell_assignment</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 27
##   voxel   corr group stage structure_name     x     y     z structure_id level_1
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  
## 1 E13pt… 0.671 ctx_… E13   intermediate …     6    19     2    111220558 forebr…
## 2 E13pt… 0.580 dien… E13   intermediate …    20    18     8        16409 forebr…
## 3 E13pt… 0.471 ge_c… E13   periventricul…    14    12     6        15837 forebr…
## # … with 17 more variables: level_2 &lt;chr&gt;, level_3 &lt;chr&gt;, level_4 &lt;chr&gt;,
## #   level_5 &lt;chr&gt;, level_6 &lt;chr&gt;, level_7 &lt;lgl&gt;, level_8 &lt;lgl&gt;, level_9 &lt;lgl&gt;,
## #   level_10 &lt;lgl&gt;, custom_1 &lt;chr&gt;, custom_2 &lt;chr&gt;, custom_3 &lt;chr&gt;,
## #   custom_4 &lt;chr&gt;, stratum &lt;chr&gt;, idx &lt;dbl&gt;, ge_annot &lt;chr&gt;, ctx_annot &lt;chr&gt;</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonas Simon Fleck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
