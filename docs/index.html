<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Projecting single-cell transcriptomes to spatial brain maps • VoxHunt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Projecting single-cell transcriptomes to spatial brain maps">
<meta property="og:description" content="Annotate brain organoid cell identities and find brain structure markers through reference atlas queries.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">VoxHunt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/install.html">Install</a>
</li>
<li>
  <a href="articles/getting_started.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/getting_started.html">Exploing the Allen Brain Atlas</a>
    </li>
    <li>
      <a href="articles/other_references.html">Other references</a>
    </li>
    <li>
      <a href="articles/deconvolution.html">Deconvolution</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://bsse.ethz.ch/qdb">
    <span class="fas fa-university fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/quadbiolab/VoxHunt">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="voxhunt-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#voxhunt-" class="anchor"></a>VoxHunt <img src="reference/figures/logo.png" align="right" width="150">
</h1></div>
<p>VoxHunt is a package for assessing brain organoid patterning, developmental state, and cell composition through systematic comparisons of single cell transcriptomes to three-dimensional in situ hybridization data from the Allen Brain Atlas and a number of other useful reference datasets.</p>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h2>
<p>VoxHunt currently implements the following features:</p>
<ul>
<li>Exploration of gene expression in the developing mouse brain</li>
<li>Discovery of brain structure markers</li>
<li>Comparison of scRNA-seq data to
<ul>
<li>ISH data from the <a href="https://developingmouse.brain-map.org/">Allen Developing Mouse Brain Atlas</a>
</li>
<li>bulk RNA-seq data of brain regions in the developing human brain (<a href="https://www.brainspan.org/">BrainSpan</a>)</li>
<li>scRNA-seq data from the developing mouse brain (<a href="https://www.biorxiv.org/content/10.1101/2020.07.02.184051v1">La Manno &amp; Siletti et al.</a>)</li>
</ul>
</li>
<li>Visualization of spatial similarity patterns</li>
<li>Annotation of cells with brain regional identities</li>
<li>Deconvolution of bulk RNA-seq data based on brain structure expression patterns</li>
</ul>
<p><a></a> <img src="reference/figures/abstract.png" align="center"></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><a href="https://github.com/immunogenomics/presto">Presto</a>, one of VoxHunt’s dependencies is not on CRAN and has to be installed from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages('devtools')</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'immunogenomics/presto'</span><span class="op">)</span></code></pre></div>
<p>If you want to perform deconvolution, you also have to install EPIC manually:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'GfellerLab/EPIC'</span><span class="op">)</span></code></pre></div>
<p>Once all external dependencies are installed, you can install VoxHunt with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'quadbiolab/voxhunt'</span><span class="op">)</span></code></pre></div>
<p>In addition to the R package itself, you’ll also need to download the the ABA expression data from <a href="http://dx.doi.org/10.17632/g4xg38mwcn.2">here</a>.</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p>If you have a <code>seurat_object</code> with single cell transcriptomic data of your organoid ready, you can start right away with projecting them to the brain:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load VoxHunt</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/quadbiolab/VoxHunt">voxhunt</a></span><span class="op">)</span>

<span class="co"># Point VoxHunt to ABA expression data</span>
<span class="fu"><a href="reference/load_aba_data.html">load_aba_data</a></span><span class="op">(</span><span class="st">'~/path/to/data'</span><span class="op">)</span>

<span class="co"># Find 300 most variable genes from the E13.5 mouse brain</span>
<span class="va">genes_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/variable_genes.html">variable_genes</a></span><span class="op">(</span><span class="st">'E13'</span>, <span class="fl">300</span><span class="op">)</span><span class="op">$</span><span class="va">gene</span>

<span class="co"># Calculate the similarity map of a seurat object to the E13.5 mouse brain</span>
<span class="va">vox_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/voxel_map.html">voxel_map</a></span><span class="op">(</span><span class="va">seurat_object</span>, genes_use<span class="op">=</span><span class="va">genes_use</span><span class="op">)</span>

<span class="co"># Plot the result</span>
<span class="fu"><a href="reference/plot_map.html">plot_map</a></span><span class="op">(</span><span class="va">vox_map</span><span class="op">)</span></code></pre></div>
<p>After loading VoxHunt, we first point it to the directory with the unpacked <a href="http://dx.doi.org/10.17632/g4xg38mwcn.1">ABA expression data</a>. Then, we select the 300 most variable features from the E13.5 mouse brain ISH data and use them to calculate similarity maps for your organoid cells. Finally, we plot these maps in the sagittal view.</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>If you find VoxHunt useful for your research, please consider citing our paper:</p>
<p><a href="https://doi.org/10.1016/j.stem.2021.02.015">Fleck, JS, Sanchís-Calleja F et al., Resolving organoid brain region identities by mapping single-cell genomic data to reference atlases. Cell Stem Cell, 2020, https://doi.org/10.1016/j.stem.2021.02.015</a></p>
<pre><code>@Article{,
    title = {Resolving organoid brain region identities by mapping single-cell genomic data to reference atlases},
    author = {Jonas Simon Fleck and Fátima Sanchís-Calleja and Zhisong He and Margozata Santel and Michael James Boyle and J. Gray Camp and Barbara Treutlein},
    journal = {Cell Stem Cell},
    year = {2021},
    url = {https://doi.org/10.1016/j.stem.2021.02.015},
    doi = {10.1016/j.stem.2021.02.015}
}</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/quadbiolab/VoxHunt">https://​github.com/​quadbiolab/​VoxHunt</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/mit-license.php">MIT</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing voxhunt</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jonas Simon Fleck <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4686-7254" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jonas Simon Fleck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
